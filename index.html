<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="UTF-8">
  <title>Naročila - Natakar</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    label { display: block; margin-top: 10px; }
    input, button { margin-top: 5px; padding: 5px; }
    .items-summary { margin-top: 15px; font-weight: bold; }
    .total { margin-top: 15px; font-size: 18px; font-weight: bold; }
    button { cursor: pointer; }
  </style>
</head>
<body>
  <h1>Naročila - Natakar</h1>
  <label>Ime natakarja: <input id="waiter" type="text"></label>
  <label>Številka mize: <input id="table" type="number" value="0"></label>

  <h3>Artikli</h3>
  <div id="menu"></div>

  <div id="itemsSummary" class="items-summary"></div>
  <div id="total" class="total">Skupaj: 0 €</div>

  <button onclick="sendOrder()">Pošlji naročilo</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAuFCkvfNrRDqdboajGnVI4eKGoDjQRk5M",
      authDomain: "blagajnalukovek.firebaseapp.com",
      databaseURL: "https://blagajnalukovek-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "blagajnalukovek",
      storageBucket: "blagajnalukovek.firebasestorage.app",
      messagingSenderId: "642858971177",
      appId: "1:642858971177:web:8e91684446fd670bd0ec38",
      measurementId: "G-6G33YYN9T1"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const prices = { "Pivo": 3, "Vino": 2.5, "Čevapčiči": 7, "Hotdog": 4 };
    const items = { "Pivo": 0, "Vino": 0, "Čevapčiči": 0, "Hotdog": 0 };

    function updateDisplay() {
      let total = 0;
      let summaryText = "";
      for (let item in items) {
        total += items[item] * prices[item];
        if (items[item] > 0) {
          summaryText += `${item} (${items[item]}) `;
        }
      }
      document.getElementById("itemsSummary").innerText = summaryText.trim();
      document.getElementById("total").innerText = "Skupaj: " + total.toFixed(2) + " €";
    }

    function addItem(item) {
      items[item]++;
      updateDisplay();
    }

    function sendOrder() {
      const waiter = document.getElementById("waiter").value;
      const table = document.getElementById("table").value;

      let total = 0;
      for (let item in items) {
        total += items[item] * prices[item];
      }

      const order = {
        waiter: waiter,
        table: table,
        items: items,
        total: total,
        status: "V čakanju"
      };

      db.ref("orders").push(order);

      // reset polja
      document.getElementById("table").value = 0;
      for (let item in items) items[item] = 0;
      updateDisplay();
    }

    // Gumbi menija
    const menuDiv = document.getElementById("menu");
    for (let item in prices) {
      const btn = document.createElement("button");
      btn.innerText = `${item} (${prices[item]} €)`;
      btn.onclick = () => addItem(item);
      menuDiv.appendChild(btn);
    }

    updateDisplay();
  </script>
</body>
</html>
