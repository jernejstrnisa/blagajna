<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="UTF-8">
  <title>Naročila – uporabnik</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .artikli { display: flex; gap: 15px; margin-top: 20px; }
    .artikel {
      border: 1px solid #ccc; padding: 20px; cursor: pointer;
      border-radius: 8px; text-align: center; width: 120px;
    }
    .artikel:hover { background: #f0f0f0; }
    .kosarica { margin-top: 20px; }
    button { margin-top: 10px; padding: 10px; border-radius: 6px; }
  </style>
</head>
<body>
  <h2>Naročilo</h2>
  <label>Številka mize: <input type="number" id="miza"></label><br><br>
  <label>Ime: <input type="text" id="ime"></label><br><br>

  <div class="artikli">
    <div class="artikel" onclick="dodajArtikel('Špricar', 2.5)">Špricar<br>2.5€</div>
    <div class="artikel" onclick="dodajArtikel('Pivo', 3)">Pivo<br>3€</div>
    <div class="artikel" onclick="dodajArtikel('Liter', 7)">Liter<br>7€</div>
    <div class="artikel" onclick="dodajArtikel('Čevapčiči', 10)">Čevapčiči<br>10€</div>
  </div>

  <div class="kosarica">
    <h3>Košarica</h3>
    <ul id="kosarica"></ul>
    <p><strong>Skupaj: <span id="skupaj">0</span> €</strong></p>
    <button onclick="posljiNarocilo()">Pošlji naročilo</button>
    <button onclick="resetKosarica()">Ponastavi</button>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyC5KUuTYzL38tlV0LoZpUKfyZgUKKT6Fps",
      authDomain: "lukovekblagajna.firebaseapp.com",
      databaseURL: "https://lukovekblagajna-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "lukovekblagajna",
      storageBucket: "lukovekblagajna.firebasestorage.app",
      messagingSenderId: "931349409467",
      appId: "1:931349409467:web:92a3be614d9e308e18439e",
      measurementId: "G-7P9RZG602T"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let kosarica = [];

    function dodajArtikel(ime, cena) {
      let najden = kosarica.find(a => a.ime === ime);
      if (najden) { najden.kolicina++; }
      else { kosarica.push({ime, cena, kolicina: 1}); }
      prikaziKosarico();
    }

    function prikaziKosarico() {
      const ul = document.getElementById("kosarica");
      ul.innerHTML = "";
      let skupaj = 0;
      kosarica.forEach(a => {
        skupaj += a.cena * a.kolicina;
        const li = document.createElement("li");
        li.textContent = `${a.ime} x${a.kolicina} = ${a.cena*a.kolicina}€`;
        ul.appendChild(li);
      });
      document.getElementById("skupaj").textContent = skupaj.toFixed(2);
    }

    function resetKosarica() {
      kosarica = [];
      document.getElementById("kosarica").innerHTML = "";
      document.getElementById("skupaj").textContent = "0";
    }

    function posljiNarocilo() {
      const miza = document.getElementById("miza").value;
      const ime = document.getElementById("ime").value;
      if (!miza || !ime || kosarica.length === 0) {
        alert("Izpolni ime, številko mize in dodaj artikel!");
        return;
      }

      const narocilo = {
        miza, ime, artikli: kosarica,
        status: "Čakanje",
        cas: Date.now()
      };

      db.ref("narocila").push(narocilo);

      resetKosarica();
      document.getElementById("miza").value = "";
      document.getElementById("ime").value = "";
      alert("Naročilo poslano!");
    }
  </script>
</body>
</html>